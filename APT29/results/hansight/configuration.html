
<!DOCTYPE html>
<html lang='en'>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-5"></script>
    <script src="/theme/scripts/analytics.js"></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='/theme/favicon-blue-m.ico' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>MITRE ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href='/theme/style/style.css' rel='stylesheet' type='text/css' />
</head>

<body>
    <header class='pb-5'>
        <nav class='navbar navbar-expand-lg navbar-dark fixed-top bg-orange border-bottom'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/ATT&CKEvals_Logo_new.png' height="30px" vspace="10" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto'>
            
            <li class="dropdown-submenu">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Evaluations</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <!-- <ul class="dropdown-menu drop_menu_side"> -->
                        <ul class="dropdown-menu drop_menu_side_right">                            
                            <li><a class="dropdown-item" href="/adversary-emulation.html">Adversary Emulation</a></li>
                            <li><a class="dropdown-item" href="/evaluation-process.html">Evaluation Process</a></li>
                            <li><a class="dropdown-item" href="/setup-and-configuration.html">Setup and Configuration</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 50px;">
                            <li><a class="dropdown-item" href="/evaluations.html?round=APT3">Results</a></li>
                            <li><a class="dropdown-item" href="/APT3">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT3/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT3/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT3/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT3/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT3
                        </a>
                        
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 90px;">
                            <li><a class="dropdown-item" href="/evaluations.html?round=APT29">Results</a></li>
                            <li><a class="dropdown-item" href="/APT29">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT29/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT29/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT29/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT29/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT29
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/get-evaluated.html">Call For Participation</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/">Overview</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/protection-categories.html">Protection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/scope.html">Technique Scope</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7
                        </a>
                    </li>
                </ul>
            </li>
                
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Tools</strong></a>
                <!-- <div class="dropdown-menu" aria-labelledby="navbarDropdown"> -->
                <div class="dropdown-menu">
                    <a class="dropdown-item" href='/technique_comparison.html'>Technique Comparison Tool </a>
                    <a class="dropdown-item" href='/do-it-yourself.html'>Do It Yourself Evaluations</a>
                    <a class="dropdown-item" href='/data_analysis_tool.html'>Data Analysis Tool</a>
                    <a class="dropdown-item" href='https://github.com/mitre-attack/attack-arsenal'>
                        ATT&CK Arsenal
                        &nbsp;<img src="https://d1zq5d3dtjfcoj.cloudfront.net/external-site.svg" alt="External site" class="external-icon">
                    </a>
                </div>  
            </li>
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/about-attack-evaluations.html">ATT&CK For Evaluations</a>
                        <a class="dropdown-item" href="/using-attack-evaluations.html">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/connect.html">Connect with ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/FAQ.html">FAQ</a>                    
                        <a class="dropdown-item" href="/issues.html">Issue Tracker</a>
                        <a class="dropdown-item" href="https://medium.com/mitre-attack/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;<img src="https://d1zq5d3dtjfcoj.cloudfront.net/external-site.svg"
                            alt="External site" class="external-icon" /> </a>
                    </div>  
                </li> 
            <li class='nav-item'><a  class='nav-link'  href='/get-evaluated.html'><strong>Get Evaluated</strong></a></li>
          </ul>
        </div>
</nav>
    </header>
    <div id='content'>
<div class='divEvaluationSummaryBody'>
    <div style='width: 100%; padding-top: 20px;'>
        <table style='width: 100%;'>
            <tr>
                <td style='width: 100%;'>
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href='/'> Home </a> &nbsp;>&nbsp; 
                            <a href='/APT29/'> APT29 </a> &nbsp;>&nbsp;
                            <a href='/evaluations.html?round=APT29'> Results </a> &nbsp;>&nbsp; 
                            <a href='/APT29/results/hansight'> HanSight </a> &nbsp;>&nbsp; Configuration
                        </span>
                    </div>
                </td>
            </tr>
        </table>
    </div>
	<div class='divFAQBody pb-4 mt-5'>
        <div class="mt-3">
            <h1>HanSight Configuration</h1>
        </div>
        <h3 class="mt-3">Description</h3>
        <p class="p-methodology">
            <strong>HanSight Enterprise SIEM</strong> – A next-generation SIEM platform that enables security teams to accurately detect and prioritize threats across the enterprise network. It provides intelligent insights that guide security teams to respond quickly to reduce the impact of incidents.
        </p>
        
        <h5 class="mt-3">Product Architecture</h5>
        <p class="p-methodology">
            <center><img src="https://d1zq5d3dtjfcoj.cloudfront.net/hansight-product-architecture.png"></center>
            The HanSight Enterprise SIEM inherits a modern SIEM architecture, which accelerates the threat management process through a well-vetted big data platform, a flexible data collection module, a blend of analytics methods, and a streamlined incident management workflow.
        </p>

        <h5 class="mt-3">Data Collection</h5>
        <p class="p-methodology">
            <center><img src="https://d1zq5d3dtjfcoj.cloudfront.net/hansight-data-collections.png"></center>
            The data collection module is able to make data sources onboard fast for threat detection and analytics. In our APT Eval test, it ingested the ETW, Windows Event Log, Sysmon and AMSI log types. When we needed to adjust the endpoint telemetry, we could simply change the endpoint sensor configuration file.
        </p>
        <h5 class="mt-3">Flexible Correlation Engine</h5>
        <p class="p-methodology">
            To combat advanced threats, the HanSight Enterprise SIEM employs cross-generation analytics techniques, including signature match, threat intelligence, correlation rules, and ML/AI-based anomaly detection. In the Eval test, most of the fired alerts came from detections by correlation rules or the ML engine.
        </p>
        <p class="p-methodology">
            The correlation engine (aka “SAE engine”) can perform correlation analysis across devices and attack stages to guarantee high-fidelity alerts with low false positives. It also supports chaining interrelated detections by the Boolean operators (AND/OR/NOT) and sequence operators (FOLLOW BY, WITHIN) to form complex logic. For example, in the Eval test to detect “Abnormal Powershell executes potential attack”, we correlated the data sources from both SysMon & ETW and used the Follow_By template to do cross-stage correlation.
        </p>
        <p class="p-methodology">
            The ML-based advanced analytics also plays an integral role in detecting advanced threats. For example, we leveraged SVM (ML in lab) to generate detection models for DNS tunneling. In the case of fileless attack detection, we used both the CNN + LSTM ML engines to detect anomalous PowerShell.
        </p>

        <h5 class="mt-3">HQL (HanSight Query Language)</h5>
        <p class="p-methodology">
            The HanSight Query Language is an interactive threat hunting/investigation tool developed on ad-hoc search. The query language syntax supports Linux pipeline and SQL with over 20 commands. Its powerful search capability, with easy-to-use features such as auto-completion, has greatly helped us in the Eval test to identify relevant telemetry and alerts/incidents, benefitting not only the on-site teams but also the MSSP teams
        </p>
        <p class="p-methodology">
            For more information about the HanSight Enterprise SIEM, visit the website at <a href="https://en.hansight.com/">https://en.hansight.com/</a>
        </p>

        <h3 class="mt-3">Product Configuration</h3>
	    <p class="p-methodology">
            We use Sysmon v10.41. Attached is the <a href="https://d1zq5d3dtjfcoj.cloudfront.net/hansightsysmon.conf.xml" target="_blank">configuration file</a>. Below is the summary of captured event. We also configured blacklist/whitelist for each event, total number is greater than 1000. <br>
            Event ID 1 == Process Creation <br>
            Event ID 2 == File Creation Time <br>
            Event ID 3 == Network Connection <br>
            Event ID 5 == Process Terminated <br>
            Event ID 6 == Driver Loaded <br>
            Event ID 7 == Image Loaded <br>
            Event ID 8 == CreateRemoteThread <br>
            Event ID 9 == RawAccessRead <br>
            Event ID 10 == ProcessAccess <br>
            Event ID 11 == FileCreate <br>
            Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed <br>
            Event ID 15 == FileStream Created <br>
            Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected <br>
            Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity <br>
        </p>
	</div>
</div>
</div>

<footer class="footer p-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <div class="footer-center-responsive my-auto">
                    <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                        <img src="https://d1zq5d3dtjfcoj.cloudfront.net/mitrelogowhiteontrans.gif" style="vertical-align: center" width="144" height="66">
                    </a>
                </div>
            </div>
            <!-- <div class="w-100 p-1 footer-responsive-break"></div> -->
            <div class="col-6 text-center">
                <p>
                    &copy; 2018 - 2020, The MITRE Corporation.
                </p>
                <p>
                    MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                </p>
                <div class="row">
                    <div class="col text-right">
                        <small>
                            <a href="/privacy.html" class="footer-link">Privacy Policy</a>
                        </small>
                    </div>
                    <div class="col text-left">
                        <small>
                            <a href="/terms-of-use.html" class="footer-link">Terms of Use</a>
                        </small>
                    </div>
                </div>
            </div>
            <div class="w-100 p-2 footer-responsive-break"></div>
            <div class="col">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREattack" class="btn btn-primary w-100">
                            <!-- <i class="fa fa-twitter"></i> -->
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREattack</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact.html" class="btn btn-primary w-100">
                            Contact
                        </a>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>
    
</body>

<!-- jjli -->

</html>