<!DOCTYPE html>
<html lang='en'>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-5"></script>
    <script src="/theme/scripts/analytics.js"></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='/theme/favicon-blue-m.ico' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>MITRE ATT&CK&trade; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href='/theme/style/style.css' rel='stylesheet' type='text/css' />
</head>

<body>
    <header class='pb-5'>
        <nav class='navbar navbar-expand-lg navbar-dark fixed-top bg-orange border-bottom'>
        <a class='navbar-brand' href='/'><img src='/theme/images/ATT&CKEvals_Logo.png' alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto'>
            <li class='nav-item'><a  class='nav-link'  href='/evaluations.html'><strong>Evaluations</strong></a></li>
            <li class='nav-item'><a  class='nav-link'  href='/get-evaluated.html'><strong>Get Evaluated</strong></a></li>
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Methodology</strong></a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/methodology">Overview - Adversary Emulation</a>
                    <a class="dropdown-item" href="/methodology/evaluation-process.html">&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;Evaluation Process</a>
                    <a class="dropdown-item" href="/methodology/setup-and-configuration.html">&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;Setup and Configuration</a>
                    <a class="dropdown-item" href="/methodology/round1">Round 1 - APT3</a>
                    <a class="dropdown-item" href="/methodology/round1/environment.html">&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;APT3 Environment</a>
                    <a class="dropdown-item" href="/methodology/round1/scope.html">&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;APT3 Scope</a>
					<a class="dropdown-item" href="/methodology/detection-categorization.html">&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;APT3 Detection Categorization</a>
                </div>  
            </li>           
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>About</strong></a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/using-attack-evaluations.html">Using ATT&CK Evaluations</a>
                    <a class="dropdown-item" href="/FAQ.html">FAQ</a>
                    <a class="dropdown-item" href="/about-attack-evaluations.html">ATT&CK Evaluations</a>
                    <a class="dropdown-item" href="/issues.html">Issue Tracker</a>
                </div>  
            </li>
            <li class='nav-item'><a  class='nav-link'  href='https://medium.com/mitre-attack/tagged/evaluation' target="_blank"><strong>Blog</strong><img src="/theme/images/external-site.svg"
                alt="External site" class="external-icon" /></a></li>

            <li class='nav-item'>
                <a  class='nav-link'  href='/contact.html'>
                    <strong>Contact</strong>
                </a>
            </li>

          </ul>
        </div>
</nav>
    </header>
    <div id='content'><br>
<div class="divEvaluationSummaryBody">
		<div style="padding: 0px; width: 100%;"> 
			<span class="spanBreadcrumbs-results"> 
				<a href='/'> Home </a> &nbsp;>&nbsp;
				<a href='/methodology'> Methodology </a> &nbsp;>&nbsp;
				<a href='/methodology/round1'> Round 1 </a> &nbsp;>&nbsp;
				Scope
			</span>
			<br />
		</div>
	<br>
	<div class='divFAQBody'>
	   <div style="margin-top:20px; text-align: center;">
		  <h1>Scope</h1>
	   </div>
	   <br />
	<p>
		For Round 1 evaluations, we tested 56 Enterprise ATT&CK techniques across 10 ATT&CK tactics. The Initial Access tactic was considered out of scope for Round 1 evaluations. The in-scope techniques are displayed below and are also highlighted in each vendor’s results page.
	</p>
	<p>
		We divided the tested techniques into “Primary” techniques and “Enabling” techniques. Execution of many of the techniques required Command-Line Interface, Execution through API, and PowerShell. We considered these to be “Enabling” techniques for the evaluation, and we generally did not capture detections directly associated with their execution (except in cases where one of those techniques was executing the behavior under test, such as “RunAs”). Instead, we focused on the Primary technique that was performed, rather than the mechanism of execution (which was considered the Enabling technique). For example, if Process Discovery was performed via Command-Line Interface, we captured detections for Process Discovery but not Command-Line Interface.
	</p>
	<!-- <img src="/theme/images/round1_scope_navigator.png" style="width: 100%; height: auto;"/> -->
	<img src="https://d1zq5d3dtjfcoj.cloudfront.net/round1_scope_navigator.png" style="width: 100%; height: auto;"/>
	<br><br>
	<p>
		As we explained in the previous section, we divided technique execution into sequences we refer to as “Steps” to help capture detections as we performed the evaluations. Each Step corresponded to an adversary’s intended goal during an operation. We performed 20 Steps in total across two scenarios: 10 Steps corresponded to our first scenario (which used Cobalt Strike), and 10 Steps corresponded to our second scenario (which used Empire). We further divided each Step into Sub-Steps that are denoted by letters (e.g. 1A, 1B, etc.). Those Steps, Sub-Steps, and the corresponding techniques are outlined below.
	</p><br>
	<h3>First Scenario</h3>
	<p>
		We used Cobalt Strike, a commercially available red team tool, to execute our emulation for the first scenario.
	</p>
	<p onclick="testing_toggle('step1DIV')" id="hide_show" class="someClass"><strong>Step 1 - <a href="javascript:;">Initial Compromise</a></strong><test class="right"></i></p>
	 <div id="step1DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated initial compromise via a malicious executable sent in a spearphishing email. Delivery was out of scope for our evaluation, so Step 1 began with a legitimate user executing the payload on the victim host, which was a Remote Access Tool (RAT) that connected back to our attacker infrastructure for tasking. The malicious executable was a self-extracting archive that established persistence and launched an initial callback through a C2 channel.<br />
		<br>
		Step 1 tested the following techniques:
		<ul>
			<li>1.A.1 - <a href="https://attack.mitre.org/techniques/T1204" target="_blank">User Execution (T1204)</a> via <a href="https://attack.mitre.org/techniques/T1064" target="_blank">Scripting (T1064)</a> with <a href="https://attack.mitre.org/techniques/T1085" target="_blank">Rundll32 (T1085)</a></li>
				<ul><li>A legitimate user executed the payload, which launched a batch file that executed a Cobalt Strike DLL payload via Rundll32.</li></ul>
			<br><li>1.B.1 - <a href="https://attack.mitre.org/techniques/T1060" target="_blank">Registry Run Keys / Start Folder (T1060)</a></li>
				<ul><li>The launched batch file wrote a separate batch file (that will also execute the Cobalt Strike DLL payload) to the current user's Startup folder.</li></ul>
			<br><li>1.C.1 - <a href="https://attack.mitre.org/techniques/T1043" target="_blank">Commonly Used Port (T1043)</a>, <a href="https://attack.mitre.org/techniques/T1071" target="_blank">Standard Application Layer Protocol (T1071)</a>, <a href="https://attack.mitre.org/techniques/T1132" target="_blank">Data Encoding (T1132)</a></li>
				<ul><li>The executed Cobalt Strike DLL callback established a C2 channel over DNS port 53 using both NetBIOS and base64 encoding.</li></ul>
	   </p>
	  </div>
	  <p onclick="testing_toggle('step2DIV')" id="hide_show" class="someClass"><strong>Step 2 - <a href="javascript:;">Initial Discovery</a></strong><test class="right"></i></p>
	 <div id="step2DIV"  style="display:none">
	   <p class='p-methodology'> 
		We emulated initial discovery using a succession of common discovery commands executed through both the command-line interface and API calls. Discovery techniques in Step 2 targeted gaining fundamental knowledge about the system and network required before follow-on activity.		<br />
		<br>
		Step 2 tested the following techniques:
		<ul>
			<li>2.A.1 - <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The ipconfig utility was executed via cmd to enumerate local TCP/IP network configuration information.</li></ul>
			<br><li>2.A.2 - <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The arp utility was executed via cmd to enumerate local ARP configuration information.</li></ul>
			<br><li>2.B.1 – <a href="https://attack.mitre.org/techniques/T1033" target="_blank">System Owner / User Discovery (T1033)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The native echo command was executed via cmd to enumerate local environment variables associated with current user and domain.</li></ul>
			<br><li>2.C.1 – <a href="https://attack.mitre.org/techniques/T1057" target="_blank">Process Discovery (T1057)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution through API (T1106)</a></li>
				<ul><li>Native API call(s) were executed to enumerate local running processes.</li></ul>
			<br><li>2.C.2 – <a href="https://attack.mitre.org/techniques/T1057" target="_blank">Process Discovery (T1057)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The tasklist utility was executed via cmd to enumerate local running processes.</li></ul>
			<br><li>2.D.1 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The sc utility was executed via cmd to enumerate local active services.</li></ul>
			<br><li>2.D.2 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate local active services.</li></ul>
			<br><li>2.E.1 – <a href="https://attack.mitre.org/techniques/T1082" target="_blank">System Information Discovery (T1082)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The systeminfo utility was executed via cmd to enumerate local operating system configuration.</li></ul>
			<br><li>2.E.2 – <a href="https://attack.mitre.org/techniques/T1082" target="_blank">System Information Discovery (T1082)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate local operating system configuration.</li></ul>
			<br><li>2.F.1 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permissions Groups Discovery (T1069)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate members of the local system's administrators group.</li></ul>
			<br><li>2.F.2 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permissions Groups Discovery (T1069)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate members of the domain controller’s administrators group.</li></ul>
			<br><li>2.F.3 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permissions Groups Discovery (T1069)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate members of the domain administrators group.</li></ul>
			<br><li>2.G.1 – <a href="https://attack.mitre.org/techniques/T1087" target="_blank">Account Discovery (T1087)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate domain user accounts.</li></ul>
			<br><li>2.G.2 – <a href="https://attack.mitre.org/techniques/T1087" target="_blank">Account Discovery (T1087)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate detailed information about a specific user account.</li></ul>
			<br><li>2.H.1 – <a href="https://attack.mitre.org/techniques/T1012" target="_blank">Query Registry (T1012)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The reg utility was executed via cmd to enumerate a specific Registry key associated with local system policies to ensure that the user will not be prompted for credentials when elevating permissions.</li></ul>
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step3DIV')" id="hide_show" class="someClass"><strong>Step 3 - <a href="javascript:;">Privilege Escalation</a></strong><test class="right"></i></p>
	 <div id="step3DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated privilege escalation by elevating our RAT’s process integrity level from medium to high, while maintaining the current user. Step 3 began with the execution of a User Account Control (UAC) bypass technique included in Cobalt Strike. The UAC Bypass technique resulted in a high integrity process that had limited functionality, but it allowed us to inject into an already existing high-integrity process, which was not limited in functionality. The targeted high-integrity process in this case was an elevated command-prompt started previously as the legitimate user.
			<br /><br>
		Step 3 tested the following techniques:
		<ul>
			<li>3.A.1 - <a href="https://attack.mitre.org/techniques/T1088" target="_blank">Bypass User Account Control (T1088)</a> via <a href="https://attack.mitre.org/techniques/T1134" target="_blank">Access Token Manipulation (T1134)</a></li>
				<ul><li>A Cobalt Strike native UAC bypass technique was executed to steal the token of an existing high-integrity process and launch a new, high-integrity RAT with limited functionality.</li></ul>
			<br><li>3.B.1 - <a href="https://attack.mitre.org/techniques/T1057" target="_blank">Process Discovery (T1057)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a></li>
				<ul><li>Native API call(s) were executed to enumerate local running processes.</li></ul>
			<br><li>3.C.1 - <a href="https://attack.mitre.org/techniques/T1055" target="_blank">Process Injection (T1055)</a></li>
				<ul><li>The limited functionality high-integrity RAT then injected malicious code into an existing fully functional high-integrity process, resulting in a new elevated, fully functional high- integrity RAT.</li></ul>				
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step4DIV')" id="hide_show" class="someClass"><strong>Step 4 - <a href="javascript:;">Discovery for Lateral Movement</a></strong><test class="right"></i></p>
	 <div id="step4DIV"  style="display:none">
	   <p class='p-methodology'> 
		We emulated a second round of discovery using a sequence of discovery commands executed through the high-integrity command-line interface that was injected into during Step 3.C.1. Discovery techniques in Step 4 targeted knowledge about the system and network specifically related to enabling lateral movement.
			<br />
		<br>
		Step 4 tested the following techniques:
		<ul>
			<li>4.A.1 - <a href="https://attack.mitre.org/techniques/T1018" target="_blank">Remote System Discovery (T1018)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate DCs within the domain</li></ul>
			<br><li>4.A.2 - <a href="https://attack.mitre.org/techniques/T1018" target="_blank">Remote System Discovery (T1018)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The net utility was executed via cmd to enumerate hosts within the domain.</li></ul>
			<br><li>4.B.1 – <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The netsh utility was executed via cmd to enumerate local firewall configuration information.</li></ul>
			<br><li>4.C.1 – <a href="https://attack.mitre.org/techniques/T1049" target="_blank">System Network Connections Discovery (T1049)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The netstat utility was executed via cmd to enumerate local active network connections.</li></ul>
				
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step5DIV')" id="hide_show" class="someClass"><strong>Step 5 - <a href="javascript:;">Credential Access</a></strong><test class="right"></i></p>
	 <div id="step5DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated credential access in a way such that it exposed different formats of legitimate credentials. Step 5 consisted of dumping both plaintext and hashed user passwords, as well as theft of a separate user’s authentication token.<br />
		<br>
		Step 5 tested the following techniques:
		<ul>
			<li>5.A.1 – <a href="https://attack.mitre.org/techniques/T1003" target="_blank">Credential Dumping (T1003)</a> using <a href="https://attack.mitre.org/techniques/T1055" target="_blank">Process Injection (T1055)</a></li>
				<ul><li>The Cobalt Strike native Mimikatz utility was executed to dump passwords via process injection into LSASS.</li></ul>
			<br><li>5.A.2 – <a href="https://attack.mitre.org/techniques/T1003" target="_blank">Credential Dumping (T1003)</a> using <a href="https://attack.mitre.org/techniques/T1055" target="_blank">Process Injection (T1055)</a></li>
				<ul><li>The Cobalt Strike native hashdump utility was executed to dump hashes via process injection into LSASS.</li></ul>
			<br><li>5.B.1 – <a href="https://attack.mitre.org/techniques/T1134" target="_blank">Access Token Manipulation (T1134)</a></li>
				<ul><li>The Cobalt Strike native token theft utility was executed to steal and assume the token of another user’s existing process, changing the user context of the RAT process.</li></ul>
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step6DIV')" id="hide_show" class="someClass"><strong>Step 6 - <a href="javascript:;">Lateral Movement</a></strong><test class="right"></i></p>
	 <div id="step6DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated lateral movement by establishing a Remote Desktop Protocol (RDP) connection to a remote host. Step 6 began with discovery targeting the remote host to ensure RDP was enabled before modifying and leveraging the existing C2 channel to establish a RDP session.<br />
		<br>
		Step 6 tested the following techniques:
		<ul>
			<li>6.A.1 – <a href="https://attack.mitre.org/techniques/T1012" target="_blank">Query Registry (T1012)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The reg utility was executed via cmd to remotely enumerate a specific Registry key associated with terminal services to ensure RDP was enabled.</li></ul>
			<br><li>6.B.1 – <a href="https://attack.mitre.org/techniques/T1043" target="_blank">Commonly Used Port (T1043)</a>, <a href="https://attack.mitre.org/techniques/T1071" target="_blank">Standard Application Layer Protocol (T1071)</a>, and <a href="https://attack.mitre.org/techniques/T1026" target="_blank">Multiband Communication (T1026)</a></li>
				<ul><li>The existing C2 channel was modified to callback over HTTP port 80 as well as the existing DNS channel.</li></ul>
			<br><li>6.C.1 – <a href="https://attack.mitre.org/techniques/T1076" target="_blank">Remote Desktop Protocol (T1076)</a></li>
				<ul><li>The existing C2 channel was used to proxy a RDP connection to a target remote host.</li></ul>			
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step7DIV')" id="hide_show" class="someClass"><strong>Step 7 - <a href="javascript:;">Persistence</a></strong><test class="right"></i></p>
	 <div id="step7DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated persistence using two distinct mechanisms. Step 7 included both the addition of a new user (through the previously established lateral movement RDP connection) as well as the creation of a scheduled task on the compromised host.<br />
		<br>
		Step 7 tested the following techniques:
		<ul>
			<li>7.A.1 - <a href="https://attack.mitre.org/techniques/T1136" target="_blank">Create Account (T1136)</a> using <a href="https://attack.mitre.org/techniques/T1061" target="_blank">Graphical User Interface (T1061)</a> with residual <a href="https://attack.mitre.org/techniques/T1087" target="_blank">Account Discovery (T1087)</a></li>
				<ul><li>Through the RDP session to the remote host, the GUI Management Console utility mmc was used to add another local user account, including memberships in the local administrators and RDP-enabled groups. Use of the GUI utility also incidentally enumerated local system user accounts.</li></ul>
			<br><li>7.B.1 - <a href="https://attack.mitre.org/techniques/T1105" target="_blank">Remote File Copy (T1105)</a></li>
				<ul><li>Another Cobalt Strike DLL payload was dropped to disk on the initially compromised system.</li></ul>
			<br><li>7.C.1 - <a href="https://attack.mitre.org/techniques/T1053" target="_blank">Scheduled Tasks (T1053)</a> and <a href="https://attack.mitre.org/techniques/T1085" target="_blank">Rundll32 (T1085)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The schtasks utility was executed via cmd to create a scheduled task that executed the Cobalt Strike DLL payload whenever the user logs in.</li></ul>
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step8DIV')" id="hide_show" class="someClass"><strong>Step 8 - <a href="javascript:;">Collection</a></strong><test class="right"></i></p>
	 <div id="step8DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated collection to identify and gather information. Step 8 included locating files of interest within local and remote file systems, as well as using API calls to harvest keystrokes and a screenshot.<br />
		<br>
		Step 8 tested the following techniques:
		<ul>
			<li>8.A.1 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The native dir command executed via cmd to enumerate files in a pre-mapped drive remote file share.</li></ul>
			<br><li>8.A.2 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> via <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The tree utility was executed via cmd to enumerate files in the local filesystem of the initially compromised system.</li></ul>
			<br><li>8.B.1 – <a href="https://attack.mitre.org/techniques/T1057" target="_blank">Process Discovery (T1057)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a></li>
				<ul><li>Native API call(s) were executed to enumerate local running processes.</li></ul>
			<br><li>8.C.1 – <a href="https://attack.mitre.org/techniques/T1056" target="_blank">Input Capture (T1056)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a> with residual <a href="https://attack.mitre.org/techniques/T1010" target="_blank">Application Window Discovery (T1010)</a></li>
				<ul><li>Native API calls(s) were used to identify and collect user keystrokes from the local explorer process. Use of the Cobalt Strike native keylogging utility also incidentally enumerated contextual information about target application windows.</li></ul>
			<br><li>8.D.1 – <a href="https://attack.mitre.org/techniques/T1113" target="_blank">Screen Capture (T1113)</a> by <a href="https://attack.mitre.org/techniques/T1055" target="_blank">Process Injection (T1055)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a></li>
				<ul><li>Native API call(s) were used to inject into and collect a screenshot from the local explorer process.</li></ul>			
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step9DIV')" id="hide_show" class="someClass"><strong>Step 9 - <a href="javascript:;">Exfiltration</a></strong><test class="right"></i></p>
	 <div id="step9DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated exfiltration by locating and stealing data. Step 9 began with the discovery of specific directories of interest followed by exfiltration of a file through the existing C2 channel.<br />
		<br>
		Step 9 tested the following techniques:
		<ul>
			<li>9.A.1 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a></li>
				<ul><li>Native API call(s) were used to enumerate files in a remote file share.</li></ul>
				<br><li>9.B.1 – <a href="https://attack.mitre.org/techniques/T1039" target="_blank">Data from Network Shared Drive (T1039)</a>, <a href="https://attack.mitre.org/techniques/T1041" target="_blank">Exfiltration over C2 Channel (T1041)</a> via <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution Through API (T1106)</a></li>
				<ul><li>Native API call(s) were used to copy a target file from a remote file share through the existing DNS C2 channel.</li></ul>		
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step10DIV')" id="hide_show" class="someClass"><strong>Step 10 - <a href="javascript:;">Execution of Persistence</a></strong><test class="right"></i></p>
	 <div id="step10DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated the execution of persistence by triggering previously established persistence mechanisms. Step 10 began with a simulated user logon that triggered two RATs to execute and check-in with the attacker infrastructure, followed by a remote logon of a previously added user account.<br />
		<br>
		Step 10 tested the following techniques:
		<ul>
			<li>10.A.1 – <a href="https://attack.mitre.org/techniques/T1060" target="_blank">Registry Run Key / Startup Folder (T1060)</a> from 1.B</li>
				<ul><li>The batch file (that launches a Cobalt Strike DLL payload) in the Startup folder was executed when the user logged off and back on.</li></ul>
			<br><li>10.A.2 – <a href="https://attack.mitre.org/techniques/T1053" target="_blank">Scheduled Task (T1053)</a> from 7.C</li>
				<ul><li>The scheduled task (that launches a Cobalt Strike DLL payload) was executed when the user logged off and back on.</li></ul>
			<br><li>10.B.1 – <a href="https://attack.mitre.org/techniques/T1078" target="_blank">Valid Accounts (T1078)</a> using <a href="https://attack.mitre.org/techniques/T1076" target="_blank">RDP (T1076)</a> from 7.A</li>
				<ul><li>The previously added user account was used to authenticate and establish a RDP connection back to the remote host targeted during lateral movement.</li></ul>	
	   </p>
	  </div>
	<br>
	<h3>Second Scenario</h3>
	<p>
		We used Empire, an open-source red team tool, to execute our emulation for the second scenario.
	</p>
	  	  <p onclick="testing_toggle('step11DIV')" id="hide_show" class="someClass"><strong>Step 11 - <a href="javascript:;">Initial Compromise</a></strong><test class="right"></i></p>
	 <div id="step11DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated initial compromise via a malicious VBScript delivered through a drive-by compromise. Delivery was out of scope for our evaluation, so Step 11 began with an emulated legitimate user executing the payload on the victim host. The malicious script was a first stage payload that downloaded and executed a PowerShell payload to establish a C2 channel.<br />
		<br>
		Step 11 tested the following techniques:
		<ul>
			<li>11.A.1 – <a href="https://attack.mitre.org/techniques/T1064" target="_blank">Scripting (T1064)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>A legitimate user executed the VBScript stager, which launches PowerShell to download and execute an Empire payload.</li></ul>
			<br><li>11.B.1 – <a href="https://attack.mitre.org/techniques/T1043" target="_blank">Commonly Used Port (T1043)</a>, <a href="https://attack.mitre.org/techniques/T1071" target="_blank">Standard Application Layer Protocol (T1071)</a>, and <a href="https://attack.mitre.org/techniques/T1032" target="_blank">Standard Cryptographic Protocol (T1032)</a></li>
				<ul><li>The executed Empire payload established an encrypted C2 channel over HTTPS on TCP port 443.</li></ul>				
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step12DIV')" id="hide_show" class="someClass"><strong>Step 12 - <a href="javascript:;">Initial Discovery</a></strong><test class="right"></i></p>
	 <div id="step12DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated initial discovery using a sequence of common discovery commands executed through PowerShell, including scripting and a series of API calls. Discovery techniques in Step 12 targeted gaining fundamental knowledge about the system and network required before follow-on activity.<br />
		<br>
		Step 12 tested the following techniques:
		<ul>
			<li>12.A.1 – <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The route utility was executed via PowerShell to enumerate the local routing table.</li></ul>
			<br><li>12.A.2 – <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The ipconfig utility was executed via PowerShell to enumerate local TCP/IP network configuration information.</li></ul>
			<br><li>12.B.1 – <a href="https://attack.mitre.org/techniques/T1033" target="_blank">System Owner / User Discovery (T1033)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The whoami utility was executed via PowerShell to enumerate information about the current user context.</li></ul>
			<br><li>12.C.1 – <a href="https://attack.mitre.org/techniques/T1057" target="_blank">Process Discovery (T1057)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The qprocess utility was executed via PowerShell to enumerate local running processes.</li></ul>
			<br><li>12.D.1 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate local active services.</li></ul>
			<br><li>12.E.1 – <a href="https://attack.mitre.org/techniques/T1064" target="_blank">Scripting (T1064)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a> and <a href="https://attack.mitre.org/techniques/T1106" target="_blank">Execution through API (T1106)</a></li>
				<ul><li>The Empire WinEnum module was executed via PowerShell to execute the following Discovery and Collection techniques:</li>
					<ul><li>12.E.1.1 – <a href="https://attack.mitre.org/techniques/T1033" target="_blank">System Owner / User Discovery (T1033)</a> – WinEnum: Get-UserInfo</li>
					<li>12.E.1.2 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permission Groups Discovery (T1069)</a> – WinEnum: “AD Group Memberships”</li>
					<li>12.E.1.3 – <a href="https://attack.mitre.org/techniques/T1201" target="_blank">Password Policy Discovery (T1201)</a> – WinEnum: “Password Last Changed”</li>
					<li>12.E.1.4.1 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> – WinEnum: “Last 5 Files Opened”</li>
					<li>12.E.1.4.2 - <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> – WinEnum: “Interesting Files”</li>
					<li>12.E.1.5 – <a href="https://attack.mitre.org/techniques/T1115" target="_blank">Clipboard Data (T1115)</a> – WinEnum: “Clipboard Contents”</li>
					<li>12.E.1.6.1 – <a href="https://attack.mitre.org/techniques/T1082" target="_blank">System Information Discovery (T1082)</a> – WinEnum: Get-SysInfo</li>
					<li>12.E.1.6.2 - <a href="https://attack.mitre.org/techniques/T1082" target="_blank">System Information Discovery (T1082)</a> – WinEnum: “Windows Last Updated”</li>
					<li>12.E.1.7 – <a href="https://attack.mitre.org/techniques/T1012" target="_blank">Query Registry (T1012)</a> – WinEnum: Get-SysInfo</li>
					<li>12.E.1.8 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> – WinEnum: “Services”</li>
					<li>12.E.1.9.1 – <a href="https://attack.mitre.org/techniques/T1135" target="_blank">Network Share Discovery (T1135)</a> – WinEnum: “Available Shares”</li>
					<li>12.E.1.9.2 – <a href="https://attack.mitre.org/techniques/T1135" target="_blank">Network Share Discovery (T1135)</a> – WinEnum: “Mapped Network Drives”</li>
					<li>12.E.1.10.1 – <a href="https://attack.mitre.org/techniques/T1063" target="_blank">Security Software Discovery (T1063)</a> – WinEnum: “AV Solution</li>
					<li>12.E.1.10.2 - <a href="https://attack.mitre.org/techniques/T1063" target="_blank">Security Software Discovery (T1063)</a> – WinEnum: “Firewall Rules”</li>
					<li>12.E.1.11 - <a href="https://attack.mitre.org/techniques/T1016" target="_blank">System Network Configuration Discovery (T1016)</a> – WinEnum: Get-NetInfo – “Network Adapters”</li>
					<li>12.E.1.12 – <a href="https://attack.mitre.org/techniques/T1049" target="_blank">System Network Connections Discovery (T1049)</a> – WinEnum: Get-NetInfo – “Netstat Established Connections and Processes”</li></ul></ul>
			<br><li>12.F.1.1 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permissions Group Discovery (T1069)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate members of the Domain Administrators group.</li></ul>
			<br><li>12.F.1.2 – <a href="https://attack.mitre.org/techniques/T1069" target="_blank">Permissions Group Discovery (T1069)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate members of the local Administrators group.</li></ul>
			<br><li>12.G.1.1 – <a href="https://attack.mitre.org/techniques/T1087" target="_blank">Account Discovery (T1087)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate local system user accounts.</li></ul>
			<br><li>12.G.1.2 – <a href="https://attack.mitre.org/techniques/T1087" target="_blank">Account Discovery (T1087)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate domain user accounts.</li></ul>				
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step13DIV')" id="hide_show" class="someClass"><strong>Step 13 - <a href="javascript:;">Discovery for Lateral Movement</a></strong><test class="right"></i></p>
	 <div id="step13DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated a second round of discovery using a sequence of common discovery commands executed through PowerShell. Discovery techniques in Step 13 targeted knowledge about the system and network specifically related to enabling lateral movement.<br />
		<br>
		Step 13 tested the following techniques:
		<ul>
			<li>13.A.1 – <a href="https://attack.mitre.org/techniques/T1018" target="_blank">Remote System Discovery (T1018)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate hosts within the domain.</li></ul>
			<br><li>13.B.1 – <a href="https://attack.mitre.org/techniques/T1049" target="_blank">System Network Connections Discovery (T1049)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to enumerate local active network connections.</li></ul>
			<br><li>13.B.2 – <a href="https://attack.mitre.org/techniques/T1049" target="_blank">System Network Connections Discovery (T1049)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The netstat utility was executed via PowerShell to enumerate local active network connections.</li></ul>
			<br><li>13.C.1 – <a href="https://attack.mitre.org/techniques/T1012" target="_blank">Query Registry (T1012)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The reg utility was executed via cmd to enumerate a specific Registry key associated with local system policies to ensure that the user will not be prompted for credentials when elevating permissions.</li></ul>			
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step14DIV')" id="hide_show" class="someClass"><strong>Step 14 - <a href="javascript:;">Privilege Escalation</a></strong><test class="right"></i></p>
	 <div id="step14DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated privilege escalation by elevating our RAT’s process integrity level from medium to high, while maintaining our current user. Step 14 consisted of a UAC bypass technique native to Empire to download and execute a new stager, spawning a new high-integrity RAT.<br />
		<br>
		Step 14 tested the following techniques:
		<ul>
			<li>14.A.1 - <a href="https://attack.mitre.org/techniques/T1088" target="_blank">Bypass UAC (T1088)</a> with <a href="https://attack.mitre.org/techniques/T1105" target="_blank">Remote File Copy (T1105)</a>, <a href="https://attack.mitre.org/techniques/T1071" target="_blank">Standard Application Layer Protocol (T1071)</a>, <a href="https://attack.mitre.org/techniques/T1043" target="_blank">Commonly Used Port (T1043)</a></li>
				<ul><li>The Empire native UAC bypass attack was executed to steal the token of an existing high-integrity process, download a new payload over HTTP port 8080 and execute it, resulting in a RAT running in a high-integrity context.</li></ul>			
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step15DIV')" id="hide_show" class="someClass"><strong>Step 15 - <a href="javascript:;">Credential Access</a></strong><test class="right"></i></p>
	 <div id="step15DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated credential access to identify and gather passwords. Step 15 included harvesting keystrokes from the initially compromised system as well as stealing files containing credentials from a remote file share.<br />
		<br>
		Step 15 tested the following techniques:
		<ul>
			<li>15.A.1 – <a href="https://attack.mitre.org/techniques/T1056" target="_blank">Input Capture (T1056)</a> with residual <a href="https://attack.mitre.org/techniques/T1010" target="_blank">Application Window Discovery (T1010)</a></li>
				<ul><li>The Empire native keylogger module was executed to collect keystrokes from local processes, including login credentials and accesses to sensitive files. Use of the Empire native keylogger module also incidentally enumerated contextual information about target application windows.</li></ul>
			<br><li>15.B.1 – <a href="https://attack.mitre.org/techniques/T1081" target="_blank">Credentials in Files (T1081)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native Get-Content cmdlet was executed via PowerShell to copy a target file from a remote file share previously identified during the keylogging process as containing credentials.</li></ul>	
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step16DIV')" id="hide_show" class="someClass"><strong>Step 16 - <a href="javascript:;">Lateral Movement</a></strong><test class="right"></i></p>
	 <div id="step16DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated lateral movement via a sequence of actions to obtain and employ credentials to access and execute on remote hosts. Step 16 began with a brute force technique to expose valid credentials, followed by a remote file copy and execution of a VBScript stager through a new service.<br />
		<br>
		Step 16 tested the following techniques:
		<ul>
			<li>16.A.1 – <a href="https://attack.mitre.org/techniques/T1110" target="_blank">Brute Force (T1110)</a> to <a href="https://attack.mitre.org/techniques/T1077" target="_blank">Windows Admin Shares (T1077)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to brute force password spraying authentication attempts to remote admin shares.</li></ul>
			<br><li>16.B.1 – <a href="https://attack.mitre.org/techniques/T1078" target="_blank">Valid Accounts (T1078)</a> to <a href="https://attack.mitre.org/techniques/T1077" target="_blank">Windows Admins Shares (T1077)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a> because of <a href="https://attack.mitre.org/techniques/T1110" target="_blank">Brute Force (T1110)</a></li>
				<ul><li>The net utility was executed via PowerShell to successfully authenticate to and mount a remote admin share using credentials of a separate user exposed by the brute force.</li></ul>
			<br><li>16.C.1 – <a href="https://attack.mitre.org/techniques/T1126" target="_blank">Network Share Connection Removal (T1126)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to remove the previous mapped remote admin share.</li></ul>
			<br><li>16.D.1 – <a href="https://attack.mitre.org/techniques/T1077" target="_blank">Windows Admin Shares (T1077)</a> using <a href="https://attack.mitre.org/techniques/T1078" target="_blank">Valid Accounts (T1078)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The net utility was executed via PowerShell to successfully authenticate to and mount a remote admin share on the domain controller.</li></ul>
			<br><li>16.E.1 – <a href="https://attack.mitre.org/techniques/T1105" target="_blank">Remote File Copy (T1105)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>Another Empire stager was dropped to disk on the initial victim.</li></ul>
			<br><li>16.F.1 – <a href="https://attack.mitre.org/techniques/T1059" target="_blank">Command-Line Interface (T1059)</a></li>
				<ul><li>The Empire native runas module was executed to execute the Empire stager via cmd using the credentials previously exposed as useful by the brute force.</li></ul>
			<br><li>16.G.1 - <a href="https://attack.mitre.org/techniques/T1105" target="_blank">Remote File Copy (T1105)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native move command was executed via PowerShell to copy the Empire stager to the domain controller.</li></ul>
			<br><li>16.H.1 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The sc utility was executed via PowerShell to enumerate active services on the domain controller.</li></ul>
			<br><li>16.I.1 – <a href="https://attack.mitre.org/techniques/T1050" target="_blank">New Service (T1050)</a> and <a href="https://attack.mitre.org/techniques/T1036" target="_blank">Masquerading (T1036)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The sc utility was executed via PowerShell to create and attempt to disguise a new service on the domain controller.</li></ul>
			<br><li>16.J.1 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The sc utility was executed via PowerShell to enumerate the newly created service on the domain controller.</li></ul>
			<br><li>16.K.1 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native type command was executed via PowerShell to enumerate the Empire stager previously copied to the domain controller.</li></ul>
			<br><li>16.L.1 – <a href="https://attack.mitre.org/techniques/T1035" target="_blank">Service Execution (T1035)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The sc utility was executed via PowerShell to launch the newly created service on the domain controller, executing the Empire stager and creating a new, elevated RAT on the domain controller.</li></ul>			
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step17DIV')" id="hide_show" class="someClass"><strong>Step 17 - <a href="javascript:;">Persistence</a></strong><test class="right"></i></p>
	 <div id="step17DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated persistence via a sequence of actions to maliciously abuse accessibility programs as a persistence mechanism. Step 17 began with discovery to ensure RDP was enabled on the domain controller before swapping the binary of the magnify accessibility feature. These techniques are performed using the RAT on the domain controller.<br />
		<br>
		Step 17 tested the following techniques:
		<ul>
			<li>17.A.1 – <a href="https://attack.mitre.org/techniques/T1007" target="_blank">System Service Discovery (T1007)</a> and <a href="https://attack.mitre.org/techniques/T1012" target="_blank">Query Registry (T1012)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The reg utility was executed via PowerShell to identify a specific Registry key associated with terminal services to ensure RDP was enabled.</li></ul>
			<br><li>17.B.1 – <a href="https://attack.mitre.org/techniques/T1222" target="_blank">File Permissions Modification (T1222)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The takeown utility was executed via PowerShell to obtain ownership of the magnify utility binary.</li></ul>
			<br><li>17.B.2 – <a href="https://attack.mitre.org/techniques/T1222" target="_blank">File Permissions Modification (T1222)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The icacls utility was executed via PowerShell to modify the discretionary access control list for the magnify utility binary.</li></ul>
			<br><li>17.C.1 – <a href="https://attack.mitre.org/techniques/T1015" target="_blank">Accessibility Features (T1015)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native copy command was executed via PowerShell to overwrite the magnify utility binary with the cmd utility binary.</li></ul>		
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step18DIV')" id="hide_show" class="someClass"><strong>Step 18 - <a href="javascript:;">Collection</a></strong><test class="right"></i></p>
	 <div id="step18DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated collection via a sequence of actions to identify and stage collected files. Step 18 included locating files of interest within remote file shares and staging target files on the initially compromised host.<br />
		<br>
		Step 18 tested the following techniques:
		<ul>
			<li>18.A.1 – <a href="https://attack.mitre.org/techniques/T1083" target="_blank">File and Directory Discovery (T1083)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native Get-ChildItem cmdlet was executed via PowerShell to enumerate files in a remote file share.</li></ul>
			<br><li>18.B.1 – <a href="https://attack.mitre.org/techniques/T1074" target="_blank">Data Staged (T1074)</a> from <a href="https://attack.mitre.org/techniques/T1039" target="_blank">Network Shared Drive (T1039)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native copy command was executed via PowerShell to copy and stage a target file from a remote file share on the initially compromised host.</li></ul>
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step19DIV')" id="hide_show" class="someClass"><strong>Step 19 - <a href="javascript:;">Exfiltration</a></strong><test class="right"></i></p>
	 <div id="step19DIV" style="display:none">
	   <p class='p-methodology'> 
			We emulated exfiltration by compressing, encrypting, and stealing data previously staged. Step 19 began with uploading and using a renamed archiving utility, WinRAR, followed by exfiltration through a network connection separate from the existing C2 channel, and finally deletion of the files that were created.<br />
		<br>
		Step 19 tested the following techniques:
		<ul>
			<li>19.A.1 – <a href="https://attack.mitre.org/techniques/T1105" target="_blank">Remote File Copy (T1105)</a> and <a href="https://attack.mitre.org/techniques/T1036" target="_blank">Masquerading (T1036)</a></li>
				<ul><li>A renamed binary of the WinRAR utility was dropped to disk on the initially compromised host.</li></ul>
			<br><li>19.B.1 – <a href="https://attack.mitre.org/techniques/T1002" target="_blank">Data Compressed (T1002)</a>, <a href="https://attack.mitre.org/techniques/T1022" target="_blank">Data Encrypted (T1022)</a>, <a href="https://attack.mitre.org/techniques/T1036" target="_blank">Masquerading (T1036)</a></li>
				<ul><li>The renamed WinRAR utility was used to create an encrypted archive of the previously staged target file.</li></ul>
			<br><li>19.C.1 - <a href="https://attack.mitre.org/techniques/T1048" target="_blank">Exfiltration over Alternative Protocol (T1048)</a></li>
				<ul><li>The ftp utility was executed to copy the previously created archive through a network connection separate of the C2 channel.</li></ul>
			<br><li>19.D.1 – <a href="https://attack.mitre.org/techniques/T1107" target="_blank">File Deletion (T1107)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native del command was executed via PowerShell to delete the previously created files.</li></ul>
			<br><li>19.D.2 – <a href="https://attack.mitre.org/techniques/T1107" target="_blank">File Deletion (T1107)</a> via <a href="https://attack.mitre.org/techniques/T1086" target="_blank">PowerShell (T1086)</a></li>
				<ul><li>The native del command was executed via PowerShell to delete the renamed WinRAR utility.</li></ul>
	   </p>
	  </div>
	  	  <p onclick="testing_toggle('step20DIV')" id="hide_show" class="someClass"><strong>Step 20 - <a href="javascript:;">Execution of Persistence</a></strong><test class="right"></i></p>
	 <div id="step20DIV"  style="display:none">
	   <p class='p-methodology'> 
			We emulated exfiltration by compressing, encrypting, and stealing data that was previously staged. Step 19 began with uploading and using a renamed archiving utility, WinRAR, followed by exfiltration through a network connection separate from the existing C2 channel, and finally deletion of the files that were created.
			<br />
		<br>
		Step 20 tested the following techniques:
		<ul>
			<li>20.A.1 – <a href="https://attack.mitre.org/techniques/T1015" target="_blank">Accessibility Features (T1015)</a> via <a href="https://attack.mitre.org/techniques/T1076" target="_blank">Remote Desktop Protocol (T1076)</a> from 17.C</li>
				<ul><li>The cmd binary that replaced the magnify binary was executed through the logon screen of an RDP connection made to the domain controller.</li></ul>
			<br><li>20.B.1 – <a href="https://attack.mitre.org/techniques/T1033" target="_blank">System Owner / User Discovery (T1033)</a></li>
				<ul><li>The native whoami command was executed via the previously launched cmd to identify information about the current user context.</li></ul>
	   </p>
	  </div>
	  <br>
	  <div class="mx-auto">
			<a class="btn btn-lg btn-navy float-left" href="/methodology/round1/environment.html" role="button">&laquo; Round 1 Environment</a>
	  </div>
	<br><br>
	</div>
</div>
</div>
    <footer class="footer pt-3 pb-2">
    <div class="container-fluid text-center">
        <a class="btn btn-primary float-right mr-4" href="https://twitter.com/MITREattack" target="_blank" rel="noopener"
           aria-label="Twitter">
            <img src="/theme/images/twitter.png" class="mx-auto d-block" width="28" height="28" alt=''> Follow ATT&CK!</a>
        <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE" class="float-left ml-4">
            <img src="/theme/images/mitrelogowhiteontrans.gif" width="144" height="66" alt=''></a>
        <br />
        <p>
            <br />
            Copyright © 2018, The MITRE Corporation. MITRE ATT&CK and ATT&CK are trademarks of The MITRE Corporation.
        </p>

        <small><a href="/privacy.html" class="footer-link">Privacy Policy</a>&nbsp;&nbsp;<a href="/terms-of-use.html"
                                                                                                 class="footer-link">Terms of Use</a></small>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>
    
    
    <script>
    function testing_toggle(id){
        $("#"+id).slideToggle();
    }
    </script>

</body>

</html>